---
import type { ImageMetadata } from "astro";
import type { HTMLAttributes } from "astro/types";
import { Picture } from "astro:assets";
import slugify from "slugify";
import TextBtn from "~/components/ui/buttons/TextBtn.astro";
import Date from "~/components/ui/Date.astro";

interface Props extends HTMLAttributes<"header"> {
  category: string;
  date: Date;
  description: string;
  heading: string;
  image?: {
    alt: string | null;
    src: ImageMetadata;
  };
}

const { category, date, heading, image }: Props = Astro.props;
---

<header class="flex flex-col gap-4 md:gap-8">
  {
    image && (
      <Picture
        src={image.src}
        widths={[480, 960]}
        sizes={`(max-width: 640px) 480px`}
        inferSize
        formats={["webp"]}
        loading="lazy"
        class="aspect-video object-cover"
        alt={image.alt ?? ""}
      />
    )
  }

  <h1 class="font-serif">{heading}</h1>

  <div class="flex items-baseline gap-1 text-sm font-medium">
    <Date class="self-center" date={date} />
    <span>|</span>
    <TextBtn
      href={`${Astro.site}posts/category/${slugify(category, { lower: true })}`}
      label={category}
    />
  </div>
</header>
